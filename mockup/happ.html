<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mockup Dashboard BI - Happ Chile</title>
    <!-- Incluimos la librería Chart.js desde un CDN para los gráficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* --- ESTILOS GENERALES Y FUENTES --- */
        @import url('https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700&display=swap');

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5; /* Un gris claro similar al fondo de Power BI Service */
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* --- CONTENEDOR PRINCIPAL DEL DASHBOARD (16:9) --- */
        .dashboard-container {
            width: 95vw;
            max-width: 1400px;
            background-color: #ffffff;
            border: 1px solid #ddd;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            aspect-ratio: 16 / 9; /* Mantiene la proporción 16:9 */
        }

        /* --- ENCABEZADO Y FILTROS --- */
        .header {
            padding: 12px 20px;
            background-color: #f7f7f7;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        .header h1 {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin: 0;
        }
        .filters {
            display: flex;
            gap: 15px;
        }
        .filters select, .filters input {
            padding: 6px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
        }

        /* --- PESTAÑAS DE NAVEGACIÓN --- */
        .tabs {
            display: flex;
            border-bottom: 2px solid #01B8AA; /* Color corporativo Happ */
            background-color: #fff;
            padding: 0 20px;
            flex-shrink: 0;
        }
        .tab-link {
            background-color: transparent;
            border: none;
            padding: 14px 18px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: #555;
            transition: color 0.2s, border-bottom 0.2s;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px; /* Alinea con el borde inferior del contenedor */
        }
        .tab-link:hover {
            color: #000;
        }
        .tab-link.active {
            color: #01B8AA;
            border-bottom: 3px solid #01B8AA;
        }

        /* --- CONTENIDO DE LAS PESTAÑAS --- */
        .tab-content-wrapper {
            flex-grow: 1;
            padding: 20px;
            overflow: auto;
            background-color: #f0f2f5; /* Fondo del área de contenido */
        }
        .tab-content {
            display: none;
        }

        /* --- ESTILO DE TARJETAS (WIDGETS) --- */
        .card {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin: 0 0 15px 0;
        }
        .kpi-value {
            font-size: 36px;
            font-weight: 700;
            color: #01B8AA;
            margin: 0;
            line-height: 1.1;
        }
        .kpi-label {
            font-size: 14px;
            color: #666;
            margin: 5px 0 0 0;
        }
        
        /* --- GRID LAYOUT PARA DASHBOARDS --- */
        .dashboard-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: auto 1fr;
        }
        .kpi-card { grid-column: span 1; }
        .main-chart { grid-column: span 3; }
        .donut-chart { grid-column: span 1; }
        .bar-chart-1 { grid-column: span 2; }
        .bar-chart-2 { grid-column: span 2; }

        /* --- TABLA DETALLADA --- */
        .table-container {
            height: 100%;
            overflow: auto; /* Permite scroll dentro del contenedor si la tabla es grande */
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
            white-space: nowrap;
        }
        thead {
            background-color: #e9ecef;
            position: sticky;
            top: 0; /* Fija el encabezado al hacer scroll */
        }
        tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>

    <div class="dashboard-container">
        <!-- ENCABEZADO -->
        <header class="header">
            <h1>Dashboard de Salud Operacional - Happ Chile</h1>
            <div class="filters">
                <select id="empresa">
                    <option>Todas las Empresas</option>
                    <option>METBUS</option>
                    <option>FALABELLA</option>
                </select>
                <select id="sucursal">
                    <option>Todas las Sucursales</option>
                    <option>METBUS-PROVIDENCIA</option>
                    <option>FALABELLA-CENTRAL</option>
                </select>
                <input type="date" id="fecha_inicio" value="2025-01-01">
                <input type="date" id="fecha_fin" value="2025-12-31">
            </div>
        </header>

        <!-- PESTAÑAS -->
        <div class="tabs">
            <button class="tab-link active" onclick="openTab(event, 'Resumen')">Resumen General</button>
            <button class="tab-link" onclick="openTab(event, 'AnalisisRiesgo')">Análisis de Riesgo</button>
            <button class="tab-link" onclick="openTab(event, 'Detalle')">Reporte Detallado</button>
        </div>

        <!-- CONTENIDO DE LAS PESTAÑAS -->
        <div class="tab-content-wrapper">

            <!-- Pestaña 1: Resumen General -->
            <div id="Resumen" class="tab-content dashboard-grid" style="display: grid;">
                <div class="card kpi-card">
                    <p class="kpi-value">4.521</p>
                    <p class="kpi-label">Total Atenciones</p>
                </div>
                <div class="card kpi-card">
                    <p class="kpi-value">1.830</p>
                    <p class="kpi-label">Personas Únicas Evaluadas</p>
                </div>
                <div class="card kpi-card">
                    <p class="kpi-value">38%</p>
                    <p class="kpi-label">% Riesgo Alto (General)</p>
                </div>
                <div class="card kpi-card">
                    <p class="kpi-value">Metbus</p>
                    <p class="kpi-label">Empresa con más Atenciones</p>
                </div>

                <div class="card main-chart">
                    <h2 class="card-title">Atenciones por Mes</h2>
                    <canvas id="atencionesMesChart"></canvas>
                </div>
                <div class="card donut-chart">
                    <h2 class="card-title">Atenciones por Tipo</h2>
                    <canvas id="tipoOperativoChart"></canvas>
                </div>
            </div>

            <!-- Pestaña 2: Análisis de Riesgo por Patología -->
            <div id="AnalisisRiesgo" class="tab-content dashboard-grid">
                <div class="card" style="grid-column: span 4;">
                    <h2 class="card-title">Distribución de Riesgo por Patología</h2>
                    <canvas id="riesgoPatologiaChart"></canvas>
                </div>
                <div class="card bar-chart-1">
                    <h2 class="card-title">Distribución de IMC</h2>
                    <canvas id="imcChart"></canvas>
                </div>
                <div class="card bar-chart-2">
                     <h2 class="card-title">Distribución Presión Sistólica</h2>
                    <canvas id="sistolicaChart"></canvas>
                </div>
            </div>

            <!-- Pestaña 3: Reporte Detallado -->
            <div id="Detalle" class="tab-content">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Rut Persona</th>
                                <th>Nombre</th>
                                <th>Edad</th>
                                <th>Tipo Operativo</th>
                                <th>Fecha de Operativo</th>
                                <th>Empresa</th>
                                <th>Sucursal</th>
                                <th>Profesional</th>
                                <th>IMC</th>
                                <th>Sistólica</th>
                                <th>Diastólica</th>
                                <th>Glicemia</th>
                                <th>Colesterol</th>
                                <th>LDL</th>
                                <th>HDL</th>
                                <th>Triglicéridos</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>17647770-9</td>
                                <td>YERTTY AGUAYO</td>
                                <td>35</td>
                                <td>CARDIO</td>
                                <td>17/11/2025</td>
                                <td>METBUS</td>
                                <td>METBUS-PROVIDENCIA</td>
                                <td>Ana maria</td>
                                <td>35.0</td>
                                <td>135</td>
                                <td>85</td>
                                <td>140</td>
                                <td>210</td>
                                <td>135</td>
                                <td>40</td>
                                <td>180</td>
                            </tr>
                            <tr>
                                <td>17647770-10</td>
                                <td>YERTTY AGUAYO</td>
                                <td>35</td>
                                <td>AUDIOMETRIA</td>
                                <td>18/11/2025</td>
                                <td>FALABELLA</td>
                                <td>FALABELLA-CENTRAL</td>
                                <td>Ana maria</td>
                                <td>31.0</td>
                                <td>125</td>
                                <td>78</td>
                                <td>110</td>
                                <td>190</td>
                                <td>120</td>
                                <td>45</td>
                                <td>140</td>
                            </tr>
                            <tr>
                                <td>12345678-1</td>
                                <td>JUAN PEREZ</td>
                                <td>42</td>
                                <td>CARDIO</td>
                                <td>15/11/2025</td>
                                <td>METBUS</td>
                                <td>METBUS-PROVIDENCIA</td>
                                <td>Carlos Rojas</td>
                                <td>28.5</td>
                                <td>145</td>
                                <td>92</td>
                                <td>115</td>
                                <td>240</td>
                                <td>165</td>
                                <td>35</td>
                                <td>250</td>
                            </tr>
                             <tr>
                                <td>98765432-1</td>
                                <td>MARIA GONZALEZ</td>
                                <td>28</td>
                                <td>MASAJE</td>
                                <td>19/11/2025</td>
                                <td>FALABELLA</td>
                                <td>FALABELLA-CENTRAL</td>
                                <td>Laura Soto</td>
                                <td>22.1</td>
                                <td>110</td>
                                <td>70</td>
                                <td>95</td>
                                <td>180</td>
                                <td>100</td>
                                <td>60</td>
                                <td>120</td>
                            </tr>
                             <tr>
                                <td>17647770-11</td>
                                <td>YERTTY AGUAYO</td>
                                <td>35</td>
                                <td>MASAJE</td>
                                <td>19/11/2025</td>
                                <td>ARAUCANA</td>
                                <td></td>
                                <td>Ana maria</td>
                                <td>25.0</td>
                                <td>118</td>
                                <td>75</td>
                                <td>105</td>
                                <td>188</td>
                                <td>115</td>
                                <td>55</td>
                                <td>130</td>
                            </tr>
                            <!-- Más filas de datos irían aquí -->
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- LÓGICA DE NAVEGACIÓN DE PESTAÑAS ---
        function openTab(evt, tabName) {
            // Oculta todo el contenido de las pestañas
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }

            // Quita la clase "active" de todos los botones de pestaña
            tablinks = document.getElementsByClassName("tab-link");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }

            // Muestra la pestaña actual y añade la clase "active" al botón
            document.getElementById(tabName).style.display = "grid"; // Usamos grid para los dashboards
            if (tabName === 'Detalle') {
                 document.getElementById(tabName).style.display = "block"; // Usamos block para la tabla
            }
            evt.currentTarget.className += " active";
        }

        // --- CÓDIGO PARA INICIALIZAR LOS GRÁFICOS (con datos de ejemplo) ---
        // Usamos un listener para asegurarnos de que el DOM está cargado
        document.addEventListener('DOMContentLoaded', function() {
            
            // Gráfico 1: Atenciones por Mes (Líneas)
            const atencionesCtx = document.getElementById('atencionesMesChart').getContext('2d');
            new Chart(atencionesCtx, {
                type: 'line',
                data: {
                    labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul'],
                    datasets: [{
                        label: 'Atenciones',
                        data: [320, 450, 400, 550, 680, 710, 850],
                        borderColor: '#01B8AA',
                        backgroundColor: 'rgba(1, 184, 170, 0.1)',
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: { maintainAspectRatio: false }
            });

            // Gráfico 2: Atenciones por Tipo (Donut)
            const tipoCtx = document.getElementById('tipoOperativoChart').getContext('2d');
            new Chart(tipoCtx, {
                type: 'doughnut',
                data: {
                    labels: ['CARDIO', 'AUDIOMETRIA', 'MASAJE', 'KINE'],
                    datasets: [{
                        label: 'Nº Atenciones',
                        data: [1850, 1230, 980, 461],
                        backgroundColor: ['#01B8AA', '#35D6C4', '#2C8C82', '#78E8DD'],
                        borderWidth: 1
                    }]
                },
                options: { maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
            });
            
            // Gráfico 3: Distribución de Riesgo por Patología (Barras Apiladas)
            const riesgoCtx = document.getElementById('riesgoPatologiaChart').getContext('2d');
            new Chart(riesgoCtx, {
                type: 'bar',
                data: {
                    labels: ['Obesidad', 'Hipertensión', 'Dislipidemia', 'Diabetes', 'Daño Renal'],
                    datasets: [
                        { label: 'Normal', data: [800, 750, 600, 900, 1100], backgroundColor: '#5cb85c' },
                        { label: 'Riesgo/Leve', data: [500, 600, 750, 450, 300], backgroundColor: '#f0ad4e' },
                        { label: 'Moderado/Severo', data: [250, 310, 350, 150, 100], backgroundColor: '#d9534f' }
                    ]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: { x: { stacked: true }, y: { stacked: true } },
                    plugins: { legend: { position: 'top' } }
                }
            });

            // Gráfico 4 y 5: Distribución de IMC y Presión (Barras)
            const imcCtx = document.getElementById('imcChart').getContext('2d');
            new Chart(imcCtx, {
                type: 'bar',
                data: {
                    labels: ['Normal', 'Pre o Riesgo', 'Leve', 'Moderado', 'Severo'],
                    datasets: [{
                        label: 'Nº Personas',
                        data: [650, 520, 310, 180, 55],
                        backgroundColor: '#35D6C4'
                    }]
                },
                 options: { maintainAspectRatio: false, indexAxis: 'y', plugins: { legend: { display: false } }}
            });
            
            const sistolicaCtx = document.getElementById('sistolicaChart').getContext('2d');
            new Chart(sistolicaCtx, {
                type: 'bar',
                data: {
                    labels: ['Normal', 'Pre o Riesgo', 'Leve', 'Moderado', 'Severo/Crítico'],
                    datasets: [{
                        label: 'Nº Personas',
                        data: [710, 490, 350, 195, 60],
                        backgroundColor: '#2C8C82'
                    }]
                },
                 options: { maintainAspectRatio: false, indexAxis: 'y', plugins: { legend: { display: false } }}
            });
        });
    </script>

</body>
</html>
